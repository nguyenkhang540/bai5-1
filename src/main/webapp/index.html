<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Murach's Java Servlet and JSP</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body class="brg">
<div class="form-card">
    <h1>Join our email list</h1>
    <p>To join our email list, enter your name and email address
        below.</p>

    <form action="emailList" method="post">
        <input type="hidden" name="action" value="add"> <label
            for="firstName">First name</label> <input id="firstName"
                                                      name="firstName" type="text" required pattern="\S(.*\S)?"
                                                      oninvalid="this.setCustomValidity('Vui lòng nhập Tên (không được bỏ trống).')"
                                                      oninput="this.setCustomValidity('')"><br> <label
            for="lastName">Last name</label> <input id="lastName"
                                                    name="lastName" type="text" required pattern="\S(.*\S)?"
                                                    oninvalid="this.setCustomValidity('Vui lòng nhập Họ (không được bỏ trống).')"
                                                    oninput="this.setCustomValidity('')"><br> <label
            for="email">Email</label> <input id="email" name="email"
                                             type="email" required
                                             oninvalid="this.setCustomValidity(this.validity.typeMismatch ? 'Vui lòng nhập địa chỉ email hợp lệ.' : 'Vui lòng nhập Email (không được bỏ trống).')"
                                             oninput="this.setCustomValidity('')"><br>

        <button id="submit" type="submit">Join Now</button>
    </form>

    <p id="serverMessage" style="color: #c00; margin-top: 12px"></p>
</div>

<script>
    function getCookieRaw(name) {
        const m = document.cookie.match(new RegExp('(?:^|; )'
            + name.replace(/([$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1')
            + '=([^;]*)'));
        return m ? m[1] : '';
    }
    function getCookie(name) {
        const raw = getCookieRaw(name);

        return decodeURIComponent(raw.replace(/\+/g, ' '));
    }
    function delCookie(name) {
        document.cookie = name + '=; Max-Age=0; path=/';
    }

    const f = document.getElementById('firstName');
    const l = document.getElementById('lastName');
    const e = document.getElementById('email');
    const msg = document.getElementById('serverMessage');

    const cf = getCookie('firstName');
    const cl = getCookie('lastName');
    const ce = getCookie('email');
    const cm = getCookie('message');

    if (cf)
        f.value = cf;
    if (cl)
        l.value = cl;
    if (ce)
        e.value = ce;
    if (cm)
        msg.textContent = cm;

    [ 'firstName', 'lastName', 'email', 'message' ].forEach(delCookie);
</script>

</body>
</html>